# 要求仕様書（RequirementsSpecification.md）

## 目的
placeables（収納箱/作業机など）は「ブロックではなくオブジェクト」として扱い、プレイヤーが前を通過できるが、接触・近接時にインタラクトできる仕組みを追加する。

## 用語
- blocks: 土・石・木など、タイルグリッドに固定配置される障害物ブロック
- placeables: 収納箱/作業机など、設置可能なオブジェクト（通行可能、当たり判定あり）

## 要件
### 1. データ構造
- placeables専用の管理リストを用意し、種類・位置・向き・状態（開閉/使用中など）を保持する
- blocksとは別配列/別管理として扱い、衝突判定と描画を分離する

### 2. 設置/撤去
- 収納箱/作業机は所持アイテムから装備欄へ移動して設置できる
- 設置時は対象タイルが空であることを確認する
- blocksの配置と競合しないよう、placeablesの配置重なりも禁止する
- 撤去時の挙動（回収/破壊）を仕様化する

### 3. 当たり判定
- placeablesはプレイヤーの移動を妨げない
- ただし「近接判定」用の当たり判定を持つ（インタラクト可能範囲）
- 当たり判定サイズは基本36x36、必要であれば種類ごとに調整可能とする

### 4. インタラクション
- 収納箱: 近接状態でインタラクトすると開閉UIを表示できる
- 作業机: 近接状態でインタラクトするとクラフトUIを表示できる
- インタラクト用の入力（例: Eキー）と表示ガイドを追加する

### 5. 描画
- placeablesは専用スプライトとして描画する
- blocks描画とは別レイヤーで描画し、奥行き順（背景→blocks→placeables→プレイヤー→UI）を明確にする

### 6. 既存仕様への影響
- blocksは引き続き障害物扱いのまま
- 地形生成や破壊ロジックはblocksのみを対象とする

## 開発ステップ
1. placeables管理の基盤実装（配列/クラス/生成・削除のAPI）
2. 設置チェックロジックの追加（blocksとplaceablesの重なり判定）
3. placeables描画処理の追加（描画順の整理）
4. 近接判定の導入（接触または距離判定）
5. インタラクト入力とUIのひな型追加（収納箱/作業机）
6. 収納箱/作業机の個別挙動の実装

## アイテム仕様
### 共通
- 装備中のツールにより左クリックの効果が変わる
- 右クリックは「設置物の回収」にも使用する（ハンマー装備時のみ）

### ツール別の挙動
- ツルハシ
  - 装備すると、土/草/石/砂/鉱石などのブロックを破壊できる
- 斧
  - 装備すると、木/葉などのブロックを破壊できる
- ハンマー
  - 作業台の前で左クリックするとクラフトを実行する
  - 設置物（収納箱/作業机など）の前で右クリックすると所持アイテムに戻す
- 剣
  - 現在は見た目のみ（将来的に敵との戦闘に使用）

### 設置物回収の操作
- 条件: ハンマー装備中 + 対象設置物に接触
- 操作: 右クリックで回収し、所持アイテムに戻す
